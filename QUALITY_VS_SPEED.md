# 圖片質量 vs 生成速度平衡指南

## 問題：如何確保圖片質量同時不等待太久（<1分鐘/張）？

### 關鍵參數影響

#### 1. **推理步數 (num_inference_steps)**
- **太少步數 (1-5步)**: 
  - ✅ 極快（5-10秒）
  - ❌ 質量差，細節缺失，可能出現偽影
  
- **最佳步數 (15-25步)**:
  - ✅ 質量好，細節豐富
  - ✅ 速度可接受（30-50秒）
  - ✅ **推薦：20步**（最佳平衡點）
  
- **太多步數 (30+步)**:
  - ✅ 細節更多
  - ❌ 可能產生重複部分、偽影
  - ❌ 速度慢（60-90秒）
  - ❌ 邊際收益遞減

#### 2. **解析度 (width x height)**
- **低解析度 (512x896)**:
  - ✅ 極快（15-25秒）
  - ❌ 細節不足
  
- **中等解析度 (640x1152)**:
  - ✅ 質量好，速度可接受（30-50秒）
  - ✅ **推薦：640x1152**（最佳平衡）
  
- **高解析度 (768x1344+)**:
  - ✅ 細節豐富
  - ❌ 可能產生重複部分、偽影
  - ❌ 速度慢（60-90秒）
  - ❌ VRAM 需求高

#### 3. **Guidance Scale**
- **太低 (3-5)**: 創意但可能不準確
- **標準 (7.0)**: ✅ **推薦**，平衡準確性和創意
- **太高 (9-12)**: 過度飽和，可能產生偽影

#### 4. **調度器 (Scheduler)**
- **DPM++ 2M Karras**: ✅ 高質量，推薦
- **Euler Ancestral**: 快速但質量稍低
- **DDIM**: 慢但穩定

### 當前優化設置

```python
# 最佳平衡配置（<1分鐘/張，質量好）
num_steps = 20              # 20步（不是30步，避免偽影）
width = 640                 # 640px（不是768px，避免重複部分）
height = 1152               # 保持9:16比例
guidance_scale = 7.0       # 標準值
scheduler = "DPM++ 2M Karras"  # 高質量調度器
```

### 負面提示詞的重要性

強化的負面提示詞可以減少：
- 重複的身體部分
- 多餘的手指/肢體
- 解剖錯誤
- 變形

**當前負面提示詞：**
```
bad anatomy, extra limbs, extra fingers, extra arms, extra legs, 
duplicated body parts, malformed limbs, missing limbs, fused fingers, 
too many fingers, deformed, disfigured, mutation, mutated, 
bad proportions, extra digits, fewer digits, missing digits, bad hands, bad feet
```

### 質量 vs 速度對照表

| 配置 | 步數 | 解析度 | 時間 | 質量 | 推薦度 |
|------|------|--------|------|------|--------|
| 極速 | 10 | 512x896 | 15-25s | ⭐⭐ | 不推薦（質量差）|
| **平衡** | **20** | **640x1152** | **30-50s** | **⭐⭐⭐⭐** | **✅ 推薦** |
| 高質量 | 25 | 768x1344 | 60-90s | ⭐⭐⭐⭐⭐ | 可選（如果時間允許）|
| 過度 | 30+ | 1024+ | 90s+ | ⭐⭐⭐（可能偽影）| ❌ 不推薦 |

### 為什麼太多步數會產生問題？

1. **過度採樣**: 模型會過度優化，產生不自然的細節
2. **偽影累積**: 每一步都會引入微小誤差，步數越多誤差累積越多
3. **重複部分**: 模型可能開始"重複"某些特徵以填充空間

### 建議

**對於 <1分鐘/張的要求：**
- ✅ 使用 **20步**（不是30步）
- ✅ 使用 **640x1152** 解析度（不是768x1344）
- ✅ 使用 **DPM++ 2M Karras** 調度器
- ✅ 使用 **強化的負面提示詞**
- ✅ Guidance scale = **7.0

這樣可以獲得高質量圖片，同時保持在30-50秒/張的速度範圍內。

